<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korean Language Investigation - How Others See Me Section</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .investigation-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        .test-section {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .category-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .category-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .category-btn.active {
            background: rgba(255, 255, 255, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.6);
        }
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .test-card h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
        }
        .test-card p {
            margin: 0 0 15px 0;
            opacity: 0.9;
        }
        .log-output {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .language-switcher {
            margin: 15px 0;
        }
        .language-switcher button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
        }
        .language-switcher button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .hidden {
            display: none;
        }
        .findings {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .critical-issue {
            background: rgba(220, 38, 127, 0.3);
            border: 2px solid rgba(220, 38, 127, 0.6);
        }
    </style>
</head>
<body>
    <div class="investigation-container">
        <h1>ğŸ” Korean Language Investigation: "How Others See Me" Section Issue</h1>
        
        <div class="test-section">
            <h2>Language Switching Test</h2>
            <div class="language-switcher">
                <button onclick="testLanguageSwitch('en')">ğŸ‡ºğŸ‡¸ English</button>
                <button onclick="testLanguageSwitch('es')">ğŸ‡ªğŸ‡¸ Spanish</button>
                <button onclick="testLanguageSwitch('fr')">ğŸ‡«ğŸ‡· French</button>
                <button onclick="testLanguageSwitch('ko')">ğŸ‡°ğŸ‡· Korean</button>
            </div>
            <p>Current Language: <span id="currentLang">en</span></p>
        </div>

        <div class="test-section">
            <h3>Category Navigation</h3>
            <button class="category-btn active" onclick="showCategory('all')" data-translate="categories.all">All</button>
            <button class="category-btn" onclick="showCategory('know-yourself')" data-translate="categories.knowYourselfTitle">ğŸ§  Know Yourself</button>
            <button class="category-btn" onclick="showCategory('others-see-me')" data-translate="categories.howOthersSeeTitle">ğŸ‘¥ How Others See Me</button>
        </div>

        <!-- Know Yourself Tests -->
        <div class="category-section" id="knowYourselfSection">
            <h3 data-translate="categories.knowYourselfTitle">ğŸ§  Know Yourself</h3>
            <div class="test-card">
                <h3 data-translate="tests.mbti.title">16 Personalities (MBTI)</h3>
                <p data-translate="tests.mbti.description">Sample description</p>
            </div>
        </div>

        <!-- How Others See Me Tests -->
        <div class="category-section" id="othersSeeSection">
            <h3 data-translate="categories.howOthersSeeTitle">ğŸ‘¥ How Others See Me</h3>
            <div class="test-card">
                <h3 data-translate="tests.askfriends.title">See Who Knows Me Best</h3>
                <p data-translate="tests.askfriends.description">Create questions about yourself, provide YOUR answers, then see who knows you best!</p>
            </div>
            <div class="test-card">
                <h3 data-translate="tests.360assessment.title">360 Perception About Me</h3>
                <p data-translate="tests.360assessment.description">Serious, multi-perspective feedback for growth and understanding.</p>
            </div>
        </div>

        <div class="findings critical-issue">
            <h2>ğŸš¨ CRITICAL ISSUE FOUND</h2>
            <h3>Root Cause: Button Text Matching Logic Issue</h3>
            <p><strong>Problem:</strong> In the showCategory('others-see-me') function, the code looks for buttons containing "How Others See Me" text to activate. However, when the language is switched to Korean, the button text becomes "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë³´ëŠ” ë‚˜", but the JavaScript still searches for the English text "How Others See Me".</p>
            
            <p><strong>Affected Code (index.html lines 2735-2739):</strong></p>
            <pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; font-family: monospace;">
document.querySelectorAll('.category-btn').forEach(btn => {
    if (btn.textContent.includes('How Others See Me')) {
        btn.classList.add('active');
    }
});
            </pre>

            <p><strong>This causes:</strong></p>
            <ul>
                <li>âœ… Korean translation application succeeds</li>
                <li>âŒ Button activation fails (wrong button stays active)</li>
                <li>âŒ User sees content in Korean, but button state is incorrect</li>
                <li>âŒ Visual inconsistency: Korean content with English button state</li>
            </ul>
        </div>

        <div class="findings">
            <h2>âœ… Investigation Findings</h2>
            <h3>Translation System Analysis</h3>
            <p><strong>Korean Translations ARE Present:</strong></p>
            <ul>
                <li>tests.askfriends.title: "ëˆ„ê°€ ë‚˜ë¥¼ ê°€ì¥ ì˜ ì•„ëŠ”ì§€ ë³´ê¸°"</li>
                <li>tests.askfriends.description: "ë‚˜ì— ëŒ€í•œ ì§ˆë¬¸ì„ ë§Œë“¤ê³ ..."</li>
                <li>tests.360assessment.title: "360ë„ ë‚˜ì— ëŒ€í•œ ì¸ì‹"</li>
                <li>tests.360assessment.description: "ì„±ì¥ê³¼ ì´í•´ë¥¼ ìœ„í•œ ì§„ì§€í•œ..."</li>
                <li>categories.howOthersSeeTitle: "ğŸ‘¥ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë³´ëŠ” ë‚˜"</li>
            </ul>
            
            <h3>Translation Application Analysis</h3>
            <p><strong>forceUpdateAllTranslations() function WORKS correctly:</strong></p>
            <ul>
                <li>âœ… Finds all [data-translate] elements</li>
                <li>âœ… Applies Korean translations successfully</li>
                <li>âœ… Updates text content properly</li>
            </ul>

            <h3>Section Display Logic Analysis</h3>
            <p><strong>showCategory('others-see-me') function has TWO issues:</strong></p>
            <ol>
                <li><strong>Button Activation Logic:</strong> Searches for English text "How Others See Me" even when Korean is active</li>
                <li><strong>Timing Issue:</strong> Translation reapplication happens AFTER button search (line 2743-2748)</li>
            </ol>
        </div>

        <div class="findings">
            <h2>ğŸ”§ Solution</h2>
            <p><strong>Fix the button activation logic to be language-independent:</strong></p>
            <pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; font-family: monospace;">
// BEFORE (problematic):
document.querySelectorAll('.category-btn').forEach(btn => {
    if (btn.textContent.includes('How Others See Me')) {
        btn.classList.add('active');
    }
});

// AFTER (language-independent):
document.querySelectorAll('.category-btn').forEach(btn => {
    if (btn.onclick && btn.onclick.toString().includes("showCategory('others-see-me')")) {
        btn.classList.add('active');
    }
});

// OR use data-category attribute:
document.querySelector('[onclick*="others-see-me"]').classList.add('active');
            </pre>
        </div>

        <div class="log-output" id="debugLog"></div>
    </div>

    <script>
        // Simplified translation object for testing
        const translations = {
            en: {
                categories: {
                    all: "All",
                    knowYourselfTitle: "ğŸ§  Know Yourself",
                    howOthersSeeTitle: "ğŸ‘¥ How Others See Me"
                },
                tests: {
                    mbti: {
                        title: "16 Personalities (MBTI)",
                        description: "Discover your personality type"
                    },
                    askfriends: {
                        title: "See Who Knows Me Best",
                        description: "Create questions about yourself, provide YOUR answers, then see who knows you best!"
                    },
                    "360assessment": {
                        title: "360 Perception About Me",
                        description: "Serious, multi-perspective feedback for growth and understanding."
                    }
                }
            },
            ko: {
                categories: {
                    all: "ì „ì²´",
                    knowYourselfTitle: "ğŸ§  ë‚˜ë¥¼ ì•Œì•„ê°€ê¸°",
                    howOthersSeeTitle: "ğŸ‘¥ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë³´ëŠ” ë‚˜"
                },
                tests: {
                    mbti: {
                        title: "16ê°€ì§€ ì„±ê²© ìœ í˜•",
                        description: "ë‚˜ë¥¼ ì •ë§ë¡œ ì•Œ ìˆ˜ ìˆëŠ” ìµœê³ ì˜ ì„±ê²© í…ŒìŠ¤íŠ¸!"
                    },
                    askfriends: {
                        title: "ëˆ„ê°€ ë‚˜ë¥¼ ê°€ì¥ ì˜ ì•„ëŠ”ì§€ ë³´ê¸°",
                        description: "ë‚˜ì— ëŒ€í•œ ì§ˆë¬¸ì„ ë§Œë“¤ê³  ë‚´ ë‹µì„ ì œê³µí•œ í›„, ëˆ„ê°€ ë‚˜ë¥¼ ê°€ì¥ ì˜ ì•„ëŠ”ì§€ ë³´ì„¸ìš”!"
                    },
                    "360assessment": {
                        title: "360ë„ ë‚˜ì— ëŒ€í•œ ì¸ì‹",
                        description: "ì„±ì¥ê³¼ ì´í•´ë¥¼ ìœ„í•œ ì§„ì§€í•œ ë‹¤ê°ì  í”¼ë“œë°±."
                    }
                }
            }
        };

        let currentLanguage = 'en';

        function log(message) {
            const logDiv = document.getElementById('debugLog');
            logDiv.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '\n';
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function getNestedTranslation(obj, key) {
            return key.split('.').reduce((current, k) => current?.[k], obj);
        }

        function forceUpdateAllTranslations(lang) {
            log('ğŸ”„ Force updating all translations for language: ' + JSON.stringify(lang).substring(0, 50) + '...');
            const elements = document.querySelectorAll('[data-translate]');
            
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (!key) return;
                
                const value = getNestedTranslation(lang, key);
                if (value !== undefined && value !== null) {
                    const oldText = element.textContent;
                    element.textContent = value;
                    log(`âœ… Updated ${key}: "${oldText}" â†’ "${value}"`);
                } else {
                    log(`âŒ Missing translation for key: ${key}`);
                }
            });
        }

        function testLanguageSwitch(langCode) {
            log(`ğŸŒ ============ TESTING LANGUAGE SWITCH TO: ${langCode} ============`);
            currentLanguage = langCode;
            document.getElementById('currentLang').textContent = langCode;
            
            if (!translations[langCode]) {
                log('âŒ No translations found for: ' + langCode);
                return;
            }

            forceUpdateAllTranslations(translations[langCode]);
            log(`âœ… Language switch to ${langCode} completed`);
        }

        function showCategory(categoryId) {
            log(`ğŸ¯ ============ SHOWING CATEGORY: ${categoryId} ============`);
            
            // Remove active class from all category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                log(`ğŸ”„ Removed active class from button: "${btn.textContent}"`);
            });
            
            // Get category sections
            const knowYourselfSection = document.getElementById('knowYourselfSection');
            const othersSeeSection = document.getElementById('othersSeeSection');
            
            if (categoryId === 'others-see-me') {
                log('ğŸ‘¥ === OTHERS-SEE-ME CATEGORY LOGIC ===');
                
                // Show only How Others See Me section
                if (knowYourselfSection) knowYourselfSection.style.display = 'none';
                if (othersSeeSection) othersSeeSection.style.display = 'block';
                log('âœ… Section display updated: Know Yourself hidden, Others See Me visible');
                
                // PROBLEMATIC LOGIC: Find and activate the "How Others See Me" button
                log('ğŸ” Searching for button with text "How Others See Me"...');
                let buttonFound = false;
                document.querySelectorAll('.category-btn').forEach(btn => {
                    log(`ğŸ” Checking button: "${btn.textContent}"`);
                    if (btn.textContent.includes('How Others See Me')) {
                        btn.classList.add('active');
                        log(`âœ… FOUND and activated button: "${btn.textContent}"`);
                        buttonFound = true;
                    }
                });
                
                if (!buttonFound) {
                    log('âŒ NO BUTTON FOUND with text "How Others See Me"');
                    log('ğŸ” Available button texts:');
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        log(`   - "${btn.textContent}"`);
                    });
                    
                    // DEMONSTRATION: Better approach using onclick attribute
                    log('ğŸ”§ USING BETTER APPROACH: onclick attribute matching');
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        if (btn.onclick && btn.onclick.toString().includes("'others-see-me'")) {
                            btn.classList.add('active');
                            log(`âœ… FIXED: Activated button using onclick: "${btn.textContent}"`);
                        }
                    });
                }
                
                // Apply translations AFTER button logic (this works fine)
                setTimeout(() => {
                    log('ğŸ”„ Reapplying translations after 100ms delay...');
                    forceUpdateAllTranslations(translations[currentLanguage]);
                }, 100);
                
            } else if (categoryId === 'know-yourself') {
                if (knowYourselfSection) knowYourselfSection.style.display = 'block';
                if (othersSeeSection) othersSeeSection.style.display = 'none';
                
                document.querySelectorAll('.category-btn').forEach(btn => {
                    if (btn.onclick && btn.onclick.toString().includes("'know-yourself'")) {
                        btn.classList.add('active');
                    }
                });
            } else {
                // Show all sections
                if (knowYourselfSection) knowYourselfSection.style.display = 'block';
                if (othersSeeSection) othersSeeSection.style.display = 'block';
                
                document.querySelectorAll('.category-btn').forEach(btn => {
                    if (btn.onclick && btn.onclick.toString().includes("'all'")) {
                        btn.classList.add('active');
                    }
                });
            }
            
            log(`ğŸ¯ Category ${categoryId} display completed`);
        }

        // Initialize
        log('ğŸš€ Korean Language Investigation Tool Initialized');
        log('ğŸ“‹ Instructions: 1) Switch to Korean, 2) Click "How Others See Me", 3) Observe the issue');
    </script>
</body>
</html>